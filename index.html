<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø°ÙƒÙŠ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f4f7f6; padding: 20px; text-align: center; }
        .loader { display: none; margin: 20px auto; border: 5px solid #f3f3f3; border-top: 5px solid #3498db; border-radius: 50%; width: 50px; height: 50px; animation: spin 2s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .table-responsive { background: white; border-radius: 10px; padding: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

    <h2 class="mb-4">ğŸš€ Ù„ÙˆØ­Ø© ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h2>
    <div id="loading" class="loader" style="display: block;"></div>
    
    <div class="container">
        <input type="text" id="search" class="form-control mb-3" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£ÙŠ Ø¬Ù‡Ø§Ø² Ù‡Ù†Ø§...">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead class="table-dark" id="header"></thead>
                <tbody id="body"></tbody>
            </table>
        </div>
    </div>

<script>
    async function init() {
        try {
            // ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ù…Ø·Ø§Ø¨Ù‚ ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù ÙÙŠ GitHub
            const response = await fetch('device_traceability.json');
            if (!response.ok) throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            
            const data = await response.json();
            const items = data.Sheet1 || []; // Ø³Ù†Ø£Ø®Ø° Ø£ÙˆÙ„ ØµÙØ­Ø©
            
            document.getElementById('loading').style.display = 'none';
            render(items);

            document.getElementById('search').oninput = (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = items.filter(row => 
                    Object.values(row).some(v => String(v).toLowerCase().includes(term))
                );
                render(filtered);
            };
        } catch (err) {
            document.getElementById('loading').innerHTML = "âŒ Ø®Ø·Ø£: Ù„Ù… ØªØ¸Ù‡Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¹ Ù…Ù„Ù device_traceability.json";
            console.error(err);
        }
    }

    function render(list) {
        const head = document.getElementById('header');
        const body = document.getElementById('body');
        
        if (list.length === 0) {
            body.innerHTML = "<tr><td colspan='5'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td></tr>";
            return;
        }

        const keys = Object.keys(list[0]);
        head.innerHTML = `<tr>${keys.map(k => `<th>${k}</th>`).join('')}</tr>`;
        
        // Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 100 ØµÙ ÙÙ‚Ø· Ù„ØªØ¬Ù†Ø¨ ØªØ¬Ù…Ø¯ Ø§Ù„Ù…ØªØµÙØ­
        body.innerHTML = list.slice(0, 100).map(row => `
            <tr>${keys.map(k => `<td>${row[k] || ''}</td>`).join('')}</tr>
        `).join('');
    }

    init();
</script>
</body>
</html>